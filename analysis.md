# ANALYSIS

Although this stage is usually the least desired because it is common for technical people not to like to document, it turns out to be the most important of the entire process. If it is considered that a pentest has the objective of helping to improve the security posture of the evaluated organization and not a demonstration of the amazing capabilities of the pentesters, it will be understood that both the risk rating represented by the verified vulnerabilities and the specific recommendations to resolve said vulnerabilities are the most important.

This stage can be developed from the beginning of the process, it is not necessary to wait until the end. For example, reporting traditional low-risk vulnerabilities (if it has been requested by the evaluated organization), reporting findings of the "information" type and vulnerabilities whose "chaining" has already been ruled out, can be reported.

Another situation of immediate analysis and reporting is when vulnerabilities are found whose criticality is very high. This aspect depends on the risk rating used by the evaluated organization (whether its own or by regulations) and can be suggested by the pentesters.
For example, based on the PCI DSS qualitative scales, a vulnerability with a Base Score of 4 or more can be considered the threshold for immediately reporting a vulnerability.

If a regulation is not applicable, CVSS also provides a mapping from quantitative to qualitative scores and, in that case, the vulnerability would be reported when the Base Score is 7 or more. This implies that it was analyzed and rated, but also that there is already a specific recommendation for the treatment of the risk it represents.

The report itself has also evolved and today it is more common to have applications where the results can be recorded and thus better management in the treatment of vulnerabilities can be carried out.

## VULNERABILITY SCORING

The risk rating of a reported vulnerability for the organization being evaluated is something that has been discussed for a long time. There are various proposals made by individual experts, by companies in the sector, by independent organizations and by regulatory entities or those proposing regulations.
The most widely used so far is CVSS (https://www.first.org/cvss/) because it allows for the analysis of various aspects of vulnerabilities and is widely documented. It provides quantitative and qualitative ratings (a mapping between the two). OWASP also provides a form of risk rating (https://owasp.org/www-community/OWASP_Risk_Rating_Methodology). However, although it proposes two acceptable vectors (probability versus impact), it still accepts subjective criteria or criteria that depend greatly on the particular criteria of each pentester.

In the end, the result of a pentest is extremely technical and mapping the risks to which the information assets of the organization being evaluated end up being exposed is not a job for pentesters. If anything, the pentesting team can collaborate with the information security managers of the organization being evaluated as long as they adequately handle aspects such as the inventory and classification of information assets, the risk analysis corresponding to said assets and the business processes. Perhaps an exception to this rule occurs when a pentest is performed on well-known applications or those that are simple for anyone to understand. An application such as Internet banking or a virtual store or payment processing, etc. are commonly used and known, but there may still be business rules that are not known since they are handled internally (for example, the rules for evaluating the granting of a loan). 

In these cases, the pentesting team can go beyond just reporting traditional vulnerabilities and can evaluate those that allow fraud to be committed or business rules to be broken.

The ways of performing a pentest have varied greatly and, therefore, the ways of reporting as well:
- Printed reports are no longer used. PDF reports are typically generated from the application used to report the results.
- Detailed "support" processes for results through meetings are more common in traditional pentests, but in models such as Pentesting as a Service these processes are almost non-existent (they rely on collaboration tools such as Slack).
- Vulnerability reporting may conclude on the occasion that vulnerabilities are first reported. However, traditional models include at least one re-test (in which it is verified whether the vulnerability was adequately addressed) and newer models may require multiple reports on the same vulnerability (recording only the variations from the initial report on the vulnerabilities reported in it).
- The time allocated to a pentest also impacts the delivery of results as there may or may not be time for understanding the organization and the processes/information assets affected by the reported vulnerabilities.

## REPORT

Something that is traditionally maintained is that two large sections are always expected in a report: Executive and Technical.

The Executive section must be oriented so that the results of the pentest can be shared and understood by people in the security and technology areas. 
Expecting that an administrative or managerial or strategic or business role can understand the results even at an executive level is not feasible. For example, a report that shows an injection of XXE without its relation to how to carry out a fraud is impossible to be understood by the representatives of the business area that has required the application in which the mentioned vulnerability was found. What they will be able to understand is that there is an application with a vulnerability that allows breaking a business rule that causes losing or stopping earning money.

The Technical section can record diverse information that depends on what is required by the evaluated organization (for example, a list of targets with their open ports may or may not be part of the Technical section). What you should always include is the most complete documentation possible of the vulnerabilities being reported:
- Specific description for the pentest, not just the concept of the vulnerability.
- Describe how the vulnerability is exploited. If it is considered easy to recreate the vulnerability check, examples with tools should be included (including the parameters used).
- The corresponding evidence through screenshots. Some people ask for videos and the truth is that it is almost impossible to do so in the allotted time because it is always exact and even short. Perhaps, the cases of protections that have not been breached can be better documented with videos and for this it is suggested to use tools such as asciinema https://asciinema.org/
- The recommendations should be specific at the level of options to select, parameters to use, software versions to which they should be updated, details of the workarounds. In the case of applications where only DAST has been done, pseudocode should be included.
- The risk rating that the vulnerability represents. Applying CVSS, for example.

### ELEMENTS DURING THE ANALYSIS
- https://www.first.org/cvss/calculator/3.1
- https://www.archerysec.com/
